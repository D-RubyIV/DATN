import{at as j,au as h,cy as N,Q as g,j as e,aw as E,ax as w,ay as I,az as R,aA as u,aB as m,aC as S,ex as C,B as k,aH as y,r as M}from"./index-BcxyKQIP.js";import{u as A,P as F}from"./useTimeOutMessage-CMeF8ZQs.js";import{r as O}from"./ClassicLayout-fQzh7gUg.js";const v=j().shape({email:h().required("Vui lòng nhập tên người dùng của bạn"),password:h().required("Vui lòng nhập mật khẩu"),rememberMe:N()}),D=o=>{const{disableSubmit:n=!1,className:r,forgotPasswordUrl:l="/auth/forgot-password",signUpUrl:i="/sign-up"}=o,[d,p]=A(),{signIn:x}=g(),f=async(t,s)=>{const{email:c,password:b}=t;s(!0);const a=await x({email:c,password:b});console.log("================================"),console.log(a),a!=null&&a.accessToken&&(localStorage.clear(),localStorage.setItem("ACCESS_TOKEN",a==null?void 0:a.accessToken)),(a==null?void 0:a.status)==="failed"&&p(a.message),s(!1)};return e.jsxs("div",{className:r,children:[d&&e.jsx(E,{showIcon:!0,className:"mb-4",type:"danger",children:e.jsx(e.Fragment,{children:d})}),e.jsx(w,{initialValues:{email:"",password:"",rememberMe:!0},validationSchema:v,onSubmit:(t,{setSubmitting:s})=>{n?s(!1):f(t,s)},children:({touched:t,errors:s,isSubmitting:c})=>e.jsx(I,{children:e.jsxs(R,{children:[e.jsx(u,{label:"Tên người dùng/email",invalid:s.email&&t.email,errorMessage:s.email,children:e.jsx(m,{type:"text",autoComplete:"off",name:"email",placeholder:"User Name",component:S})}),e.jsx(u,{label:"Mật khẩu",invalid:s.password&&t.password,errorMessage:s.password,children:e.jsx(m,{autoComplete:"off",name:"password",placeholder:"Password",component:F})}),e.jsxs("div",{className:"flex justify-between mb-6",children:[e.jsx(m,{className:"mb-0",name:"rememberMe",component:C,children:"Ghi nhớ mật khẩu"}),e.jsx(O,{to:l,children:"Quên mật khẩu?"})]}),e.jsx(k,{block:!0,loading:c,variant:"solid",type:"submit",className:`${n?"bg-gray-500 cursor-not-allowed":"bg-blue-500"}`,disabled:n,children:c?"Đăng nhập...":"Đăng Nhập"})]})})})]})},_=()=>{const{authenticated:o}=g(),n=y();return M.useEffect(()=>{const r=localStorage.getItem("admin");if(r)try{const i=JSON.parse(JSON.parse(r).auth).user.authority??[];console.log(i),o&&i.includes("ROLE_ADMIN")?(console.log("ROLE_ADMIN REDIRECT"),n("/admin/manage/home")):o&&i.includes("ROLE_USER")?(console.log("ROLE_USER REDIRECT"),n("/")):(console.log("UNKNOWN REDIRECT"),n("/auth/sign-in"))}catch(l){console.error("Failed to parse token:",l)}console.log("FROM AuthorRouteComponent authenticated: ",o)},[o]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"mb-1",children:"Chào mừng trở lại!"}),e.jsx("p",{children:"Vui lòng nhập thông tin đăng nhập của bạn để đăng nhập!"})]}),e.jsx(D,{disableSubmit:!1})]})};export{_ as default};
