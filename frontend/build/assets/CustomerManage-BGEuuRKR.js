import{aH as _,r as c,as as N,aE as g,j as e,aC as R,B as C,ce as M,aM as Q,b6 as q,aL as G,cf as O,L as S}from"./index-D4RF4o2o.js";import{h as U}from"./ClassicLayout-D6RkHwe2.js";import{I as J}from"./index.esm-BbI8Mix8.js";import{u as f,w as V,R as W,a as X}from"./xlsx-BQNmD9Ey.js";import{F as Y}from"./FileSaver.min-DhUia5MQ.js";const Z=()=>{const p=_(),[h,k]=c.useState([]),[j,b]=c.useState(!1),[w,A]=c.useState(0),[i,y]=c.useState(1),[o,$]=c.useState(10),[u,T]=c.useState(""),[m,E]=c.useState(null);c.useEffect(()=>{v(i,o,u,m)},[i,o,u,m]);const v=async(s,t,a,l)=>{b(!0);try{let r=`/customer?page=${s}&size=${t}`;a&&(r=`/customer/search?query=${a}&page=${s}&size=${t}`),l&&l!==""&&(r+=`&status=${l}`);const d=(await N.get(r)).data;let x=[];d&&d.content&&(x=d.content),k(x),A(d.totalElements||0),console.log("Fetched customers:",x),console.log("Total elements:",d.totalElements)}catch(r){console.log("Error fetching customer data: ",r),g.error("Error fetching customer data")}finally{b(!1)}},K=async(s,t)=>{try{await N.patch(`/customer/status/${s}`,{status:t?"Active":"Inactive"}),g.success("cập nhật thành công"),v(i,o,u)}catch(a){g.error("Error updating status"),console.error("Error updating status:",a)}},D=()=>{const s=h.map(n=>({STT:(i-1)*o+h.indexOf(n)+1,Name:n.name,Email:n.email,Phone:n.phone,BirthDate:n.birthDate,Gender:n.gender,Status:n.status,Address:n.defaultAddress?`${n.defaultAddress.detail}, ${n.defaultAddress.ward}, ${n.defaultAddress.district}, ${n.defaultAddress.province}`:"N/A"})),t=f.json_to_sheet(s),a=f.book_new();f.book_append_sheet(a,t,"Customer");const l=V(a,{bookType:"xlsx",type:"array"}),r=new Blob([l],{type:"application/octet-stream"});Y.saveAs(r,"customer_data.xlsx")},z=()=>{p("/admin/manage/customer/add")},I=s=>{p(`/admin/manage/customer/update/${s}`)},B=s=>{y(s)},F=s=>{$(s)},H=s=>{T(s.target.value)},L=s=>{y(1),E(s.target.value)},P=[{header:"STT",id:"serialNumber",cell:({row:s})=>(i-1)*o+s.index+1},{header:"Tên",accessorKey:"name"},{header:"Email",accessorKey:"email"},{header:"Số điện thoại",accessorKey:"phone"},{header:"Ngày sinh",accessorKey:"birthDate"},{header:"Giới tính",accessorKey:"gender"},{header:"Địa chỉ",cell:({row:s})=>{const t=s.original.defaultAddress;return t?`${t.detail}, ${t.ward}, ${t.district}, ${t.province}`:"N/A"}},{header:"Trạng thái",accessorKey:"status",cell:({row:s})=>{const{status:t}=s.original,a=t==="Active",l=a?"Hoạt động":"Không hoạt động";return e.jsxs("span",{className:`flex items-center font-bold ${a?"text-green-600":"text-red-600"}`,children:[e.jsx("span",{className:`inline-block w-2 h-2 rounded-full mr-2 ${a?"bg-green-600":"bg-red-600"}`}),l]})},size:100},{header:"Hành động",id:"action",cell:({row:s})=>{const t=s.original,{id:a,status:l}=s.original,r=l==="Active";return e.jsxs("div",{className:"flex w-full justify-start gap-2 items-center",children:[e.jsx(G,{size:20,className:"mr-3",style:{cursor:"pointer"},onClick:()=>I(t.id)}),e.jsx(O,{color:"green-500",checked:r,className:"text-sm",unCheckedContent:e.jsx(W,{}),checkedContent:e.jsx(X,{}),onChange:()=>K(a,!r)})]})}}];return e.jsxs("div",{className:"bg-white rounded-lg mb-6 w-full",children:[e.jsx("h1",{className:"font-semibold text-xl mb-4 text-transform: uppercase",children:"Quản lý khách hàng"}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"relative w-80 mr-4",children:[e.jsx(R,{placeholder:"Tìm kiếm theo tên, email, số điện thoại...",size:"sm",style:{backgroundColor:"#fff",height:"40px"},className:"w-full pl-10 pr-2 py-1 border border-gray-300 rounded focus:outline-none",onChange:H}),e.jsx(J,{style:{height:"40px"},className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-500 text-2xl"})]}),e.jsx("div",{className:"relative w-40 mr-4",children:e.jsxs("select",{className:"w-full pl-2 pr-2 py-2 border border-gray-300 rounded focus:outline-none",value:m||"",style:{backgroundColor:"#fff",height:"40px"},onChange:L,children:[e.jsx("option",{value:"",children:"Tất cả"}),e.jsx("option",{value:"Active",children:"Hoạt động"}),e.jsx("option",{value:"Inactive",children:"Không hoạt động"})]})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs(C,{size:"sm",className:"w-full h-10 flex items-center justify-center mr-4",style:{backgroundColor:"#fff",height:"40px"},onClick:D,children:[e.jsx(M,{className:"mr-2"}),"Tải Excel"]}),e.jsx(C,{size:"sm",variant:"solid",style:{backgroundColor:"rgb(79, 70, 229)",height:"40px"},className:"flex items-center justify-center gap-2 button-bg-important",icon:e.jsx(Q,{}),onClick:z,children:"Thêm mới"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:j?e.jsx("p",{children:"Đang tải..."}):h.length===0?e.jsx("p",{children:"Không có dữ liệu khách hàng."}):e.jsx(q,{columns:P,data:h,loading:j,pagingData:{pageIndex:i,pageSize:o,total:w},onPaginationChange:B,onSelectChange:F})})]})},re=()=>e.jsxs(U,{className:"h-full",bodyClass:"h-full",children:[e.jsx("div",{className:"lg:flex items-center justify-between mb-4",children:e.jsx("nav",{className:"flex","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:"inline-flex items-center space-x-1 md:space-x-3",children:[e.jsx("li",{children:e.jsx("div",{className:"flex items-center",children:e.jsx(S,{to:"/",className:"text-gray-700 hover:text-blue-600",children:"Trang Chủ"})})}),e.jsx("li",{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mx-2",children:"/"}),e.jsx(S,{to:"/manage",className:"text-gray-700 hover:text-blue-600",children:"Quản Lý"})]})}),e.jsx("li",{"aria-current":"page",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mx-2",children:"/"}),e.jsx("span",{className:"text-gray-500",children:"Khách Hàng"})]})})]})})}),e.jsx(Z,{})]});export{re as default};
