import{aH as G,r as a,j as e,L as w,aC as U,B as f,aM as J,b6 as R,aO as V,ak as D,as as T,aE as E,aL as W}from"./index-BTLFdfuL.js";import{I as Y}from"./index.esm-BE8xtpcK.js";import{a as Z}from"./index.esm-BYSg5Yzi.js";import{f as I}from"./format-B_y2kbX7.js";const le=()=>{const j=G(),[h,y]=a.useState([]),[b,v]=a.useState(!1),[H,K]=a.useState(0),[c,P]=a.useState(1),[i,M]=a.useState(5),[m,z]=a.useState(""),[x,_]=a.useState(),[$,u]=a.useState(!1),[g,N]=a.useState(null),[p,ee]=a.useState([null,null]),k=async(s,l,n,t,o)=>{v(!0);try{let r=`${D.apiPrefix}/event/all`;const d={page:s,size:l};n?(r="/event/search",d.query=n):t?(r="/event/filter",d.status=t):o&&o[0]&&o[1]&&(r=`${D.apiPrefix}/event/filter-date`,d.startDate=I(o[0],"yyyy-MM-dd'T'HH:mm:ss"),d.endDate=I(o[1],"yyyy-MM-dd'T'HH:mm:ss"));const S=await T.get(r,{params:d});y(S.data.content),K(S.data.totalElements)}catch(r){console.error("Error fetching events:",r)}finally{v(!1)}};a.useEffect(()=>{k(c,i,m,x,p)},[c,i,m,x,p]);const B=s=>{z(s.target.value)},L=()=>{j("/admin/manage/event/add")},O=s=>{console.log("Id là: ",s),j(`/admin/manage/event/update/${s}`)},X=s=>{P(s)},Q=s=>{M(s)},q=s=>{N(s),u(!0)},C=()=>{u(!1),N(null)},A=async()=>{if(console.log("Runn...."),g!==null)try{await T.delete(`/event/delete/${g}`),E.success("Xóa thành công"),y(h.filter(s=>s.id!==g)),u(!1),k(c,i,m,x,p)}catch{E.error("Xóa thất bại")}},F=[{header:"STT",id:"serialNumber",cell:({row:s})=>(c-1)*i+s.index+1},{header:"Mã",accessorKey:"discountCode"},{header:"Tên",accessorKey:"name"},{header:"Giá trị giảm(%)",accessorKey:"discountPercent"},{header:"Ngày bắt đầu",accessorKey:"startDate",cell:({row:s})=>e.jsx("p",{children:s.original.startDate})},{header:"Ngày kết thúc",accessorKey:"endDate",cell:({row:s})=>e.jsx("p",{children:s.original.endDate})},{header:"Số lượng",accessorKey:"quantityDiscount"},{header:"Trạng thái",accessorKey:"status",cell:({row:s})=>{const{status:l}=s.original;let n="",t="";switch(l){case"Đang diễn ra":n="Đang diễn ra",t="text-green-600";break;case"Sắp diễn ra":n="Sắp diễn ra",t="text-yellow-600";break;case"Đã kết thúc":n="Đã kết thúc",t="text-red-600";break;default:n="Không hoạt động",t="text-gray-600"}return e.jsxs("span",{className:`flex items-center font-bold ${t}`,children:[e.jsx("span",{className:`inline-block w-2 h-2 rounded-full mr-2 ${t.replace("text-","bg-")}`}),n]})},size:100},{header:"Hành động",cell:({row:s})=>{const l=s.original;return e.jsxs("div",{className:"flex w-full justify-start gap-2 items-center",children:[e.jsx(W,{size:20,className:"mr-3",style:{cursor:"pointer"},onClick:()=>O(l.id)}),e.jsx(Z,{size:20,style:{cursor:"pointer"},onClick:()=>q(l.id)})]})}}];return e.jsx("div",{className:"bg-white rounded-lg mb-6 w-full h-full",children:e.jsxs("div",{className:"p-5 rounded-md card h-full card-border",children:[e.jsx("div",{className:"lg:flex items-center justify-between mb-4",children:e.jsx("nav",{className:"flex","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:"inline-flex items-center space-x-1 md:space-x-3",children:[e.jsx("li",{children:e.jsx("div",{className:"flex items-center",children:e.jsx(w,{to:"/",className:"text-gray-700 hover:text-blue-600",children:"Trang Chủ"})})}),e.jsx("li",{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mx-2",children:"/"}),e.jsx(w,{to:"/manage",className:"text-gray-700 hover:text-blue-600",children:"Quản Lý"})]})}),e.jsx("li",{"aria-current":"page",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mx-2",children:"/"}),e.jsx("span",{className:"text-gray-500",children:"Đợt giảm giá"})]})})]})})}),e.jsx("h1",{className:"font-semibold text-xl mb-4 uppercase",children:"Quản lý đợt giảm giá"}),e.jsx("div",{className:"bg-white",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"relative w-[500px]",children:[e.jsx(U,{placeholder:"Tìm kiếm theo mã, tên...",size:"sm",className:"w-full pl-10 pr-2 py-2 border border-gray-300 rounded focus:outline-none bg-white h-10",onChange:B}),e.jsx(Y,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-500 text-2xl"})]})}),e.jsx(f,{variant:"solid",style:{backgroundColor:"rgb(79, 70, 229)",height:"40px"},className:"flex items-center justify-center gap-2 button-bg-important h-10",icon:e.jsx(J,{}),onClick:L,children:"Thêm mới"})]})}),e.jsx("div",{className:"bg-white rounded-lg py-6",children:e.jsx("div",{className:"overflow-x-auto",children:b?e.jsx("p",{children:"Đang tải..."}):h.length===0?e.jsx("p",{children:"Không có dữ liệu event."}):e.jsx(R,{columns:F,data:h,loading:b,pagingData:{pageIndex:c,pageSize:i,total:H},onPaginationChange:X,onSelectChange:Q})})}),e.jsxs(V,{isOpen:$,closable:!1,onClose:C,children:[e.jsx("h5",{className:"mb-4",children:"Xác nhận xóa sự kiện"}),e.jsx("p",{children:"Bạn có chắc chắn muốn xóa sự kiện này không?"}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(f,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:C,children:"Hủy"}),e.jsx(f,{variant:"solid",style:{backgroundColor:"rgb(79, 70, 229)",height:"40px"},type:"submit",onClick:A,children:"Xác nhận"})]})]})]})})};export{le as default};
