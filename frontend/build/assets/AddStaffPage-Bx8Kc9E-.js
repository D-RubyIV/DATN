import{r as f,J as Qe,j as i,cz as fe,cA as Xe,bb as he,cB as we,cC as De,cD as ce,cE as Re,cF as Ne,cG as qe,cH as Le,cI as Oe,cJ as Te,cK as Ye,cL as ge,aH as Ke,aD as A,at as Je,au as q,ak as me,cg as Ze,bM as te,cy as Ve,cM as et,B as xe,cN as tt,ax as nt,ay as at,az as st,aA as I,aB as z,aC as ne,ca as it,bf as Me,ci as be,aE as Ie,cO as rt}from"./index-CHgCMjEm.js";import{I as ot}from"./index.esm-CPTdmulS.js";import{R as lt}from"./index.esm-4DQXGO7Y.js";import{_ as ct,T as Be,u as Pe,a as We,b as Ce,o as ye,c as Ue,e as _e,d as dt,B as ut}from"./Box-BVOP-B4V.js";function Ge(e){var t;return parseInt(f.version,10)>=19?((t=e==null?void 0:e.props)==null?void 0:t.ref)||null:(e==null?void 0:e.ref)||null}const pt=Qe(i.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"CloseOutlined"),ze={disabled:!1};var ft=function(t){return t.scrollTop},le="unmounted",Z="exited",V="entering",se="entered",ke="exiting",B=function(e){ct(t,e);function t(o,s){var a;a=e.call(this,o,s)||this;var c=s,u=c&&!c.isMounting?o.enter:o.appear,h;return a.appearStatus=null,o.in?u?(h=Z,a.appearStatus=V):h=se:o.unmountOnExit||o.mountOnEnter?h=le:h=Z,a.state={status:h},a.nextCallback=null,a}t.getDerivedStateFromProps=function(s,a){var c=s.in;return c&&a.status===le?{status:Z}:null};var l=t.prototype;return l.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},l.componentDidUpdate=function(s){var a=null;if(s!==this.props){var c=this.state.status;this.props.in?c!==V&&c!==se&&(a=V):(c===V||c===se)&&(a=ke)}this.updateStatus(!1,a)},l.componentWillUnmount=function(){this.cancelNextCallback()},l.getTimeouts=function(){var s=this.props.timeout,a,c,u;return a=c=u=s,s!=null&&typeof s!="number"&&(a=s.exit,c=s.enter,u=s.appear!==void 0?s.appear:c),{exit:a,enter:c,appear:u}},l.updateStatus=function(s,a){if(s===void 0&&(s=!1),a!==null)if(this.cancelNextCallback(),a===V){if(this.props.unmountOnExit||this.props.mountOnEnter){var c=this.props.nodeRef?this.props.nodeRef.current:fe.findDOMNode(this);c&&ft(c)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Z&&this.setState({status:le})},l.performEnter=function(s){var a=this,c=this.props.enter,u=this.context?this.context.isMounting:s,h=this.props.nodeRef?[u]:[fe.findDOMNode(this),u],v=h[0],E=h[1],y=this.getTimeouts(),N=u?y.appear:y.enter;if(!s&&!c||ze.disabled){this.safeSetState({status:se},function(){a.props.onEntered(v)});return}this.props.onEnter(v,E),this.safeSetState({status:V},function(){a.props.onEntering(v,E),a.onTransitionEnd(N,function(){a.safeSetState({status:se},function(){a.props.onEntered(v,E)})})})},l.performExit=function(){var s=this,a=this.props.exit,c=this.getTimeouts(),u=this.props.nodeRef?void 0:fe.findDOMNode(this);if(!a||ze.disabled){this.safeSetState({status:Z},function(){s.props.onExited(u)});return}this.props.onExit(u),this.safeSetState({status:ke},function(){s.props.onExiting(u),s.onTransitionEnd(c.exit,function(){s.safeSetState({status:Z},function(){s.props.onExited(u)})})})},l.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},l.safeSetState=function(s,a){a=this.setNextCallback(a),this.setState(s,a)},l.setNextCallback=function(s){var a=this,c=!0;return this.nextCallback=function(u){c&&(c=!1,a.nextCallback=null,s(u))},this.nextCallback.cancel=function(){c=!1},this.nextCallback},l.onTransitionEnd=function(s,a){this.setNextCallback(a);var c=this.props.nodeRef?this.props.nodeRef.current:fe.findDOMNode(this),u=s==null&&!this.props.addEndListener;if(!c||u){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var h=this.props.nodeRef?[this.nextCallback]:[c,this.nextCallback],v=h[0],E=h[1];this.props.addEndListener(v,E)}s!=null&&setTimeout(this.nextCallback,s)},l.render=function(){var s=this.state.status;if(s===le)return null;var a=this.props,c=a.children;a.in,a.mountOnEnter,a.unmountOnExit,a.appear,a.enter,a.exit,a.timeout,a.addEndListener,a.onEnter,a.onEntering,a.onEntered,a.onExit,a.onExiting,a.onExited,a.nodeRef;var u=Xe(a,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return he.createElement(Be.Provider,{value:null},typeof c=="function"?c(s,u):he.cloneElement(he.Children.only(c),u))},t}(he.Component);B.contextType=Be;B.propTypes={};function ae(){}B.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:ae,onEntering:ae,onEntered:ae,onExit:ae,onExiting:ae,onExited:ae};B.UNMOUNTED=le;B.EXITED=Z;B.ENTERING=V;B.ENTERED=se;B.EXITING=ke;const ht=e=>e.scrollTop;function He(e,t){const{timeout:l,easing:o,style:s={}}=e;return{duration:s.transitionDuration??(typeof l=="number"?l:l[t.mode]||0),easing:s.transitionTimingFunction??(typeof o=="object"?o[t.mode]:o),delay:s.transitionDelay}}function mt(e){return De("MuiPaper",e)}we("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const gt=e=>{const{square:t,elevation:l,variant:o,classes:s}=e,a={root:["root",o,!t&&"rounded",o==="elevation"&&`elevation${l}`]};return Te(a,mt,s)},vt=ce("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:l}=e;return[t.root,t[l.variant],!l.square&&t.rounded,l.variant==="elevation"&&t[`elevation${l.elevation}`]]}})(Re(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow"),variants:[{props:({ownerState:t})=>!t.square,style:{borderRadius:e.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(e.vars||e).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),xt=f.forwardRef(function(t,l){var D;const o=Ne({props:t,name:"MuiPaper"}),s=Pe(),{className:a,component:c="div",elevation:u=1,square:h=!1,variant:v="elevation",...E}=o,y={...o,component:c,elevation:u,square:h,variant:v},N=gt(y);return i.jsx(vt,{as:c,ownerState:y,className:qe(N.root,a),ref:l,...E,style:{...v==="elevation"&&{"--Paper-shadow":(s.vars||s).shadows[u],...s.vars&&{"--Paper-overlay":(D=s.vars.overlays)==null?void 0:D[u]},...!s.vars&&s.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${Le("#fff",Oe(u))}, ${Le("#fff",Oe(u))})`}},...E.style}})});function $e(e){return e.substring(2).toLowerCase()}function bt(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}function yt(e){const{children:t,disableReactTree:l=!1,mouseEvent:o="onClick",onClickAway:s,touchEvent:a="onTouchEnd"}=e,c=f.useRef(!1),u=f.useRef(null),h=f.useRef(!1),v=f.useRef(!1);f.useEffect(()=>(setTimeout(()=>{h.current=!0},0),()=>{h.current=!1}),[]);const E=We(Ge(t),u),y=Ce(x=>{const b=v.current;v.current=!1;const R=ye(u.current);if(!h.current||!u.current||"clientX"in x&&bt(x,R))return;if(c.current){c.current=!1;return}let m;x.composedPath?m=x.composedPath().includes(u.current):m=!R.documentElement.contains(x.target)||u.current.contains(x.target),!m&&(l||!b)&&s(x)}),N=x=>b=>{v.current=!0;const R=t.props[x];R&&R(b)},D={ref:E};return a!==!1&&(D[a]=N(a)),f.useEffect(()=>{if(a!==!1){const x=$e(a),b=ye(u.current),R=()=>{c.current=!0};return b.addEventListener(x,y),b.addEventListener("touchmove",R),()=>{b.removeEventListener(x,y),b.removeEventListener("touchmove",R)}}},[y,a]),o!==!1&&(D[o]=N(o)),f.useEffect(()=>{if(o!==!1){const x=$e(o),b=ye(u.current);return b.addEventListener(x,y),()=>{b.removeEventListener(x,y)}}},[y,o]),i.jsx(f.Fragment,{children:f.cloneElement(t,D)})}function Se(e){return`scale(${e}, ${e**2})`}const Et={entering:{opacity:1,transform:Se(1)},entered:{opacity:1,transform:"none"}},Ee=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),je=f.forwardRef(function(t,l){const{addEndListener:o,appear:s=!0,children:a,easing:c,in:u,onEnter:h,onEntered:v,onEntering:E,onExit:y,onExited:N,onExiting:D,style:x,timeout:b="auto",TransitionComponent:R=B,...m}=t,C=Ue(),w=f.useRef(),W=Pe(),H=f.useRef(null),L=We(H,Ge(a),l),T=k=>O=>{if(k){const M=H.current;O===void 0?k(M):k(M,O)}},ee=T(E),G=T((k,O)=>{ht(k);const{duration:M,delay:$,easing:P}=He({style:x,timeout:b,easing:c},{mode:"enter"});let n;b==="auto"?(n=W.transitions.getAutoHeightDuration(k.clientHeight),w.current=n):n=M,k.style.transition=[W.transitions.create("opacity",{duration:n,delay:$}),W.transitions.create("transform",{duration:Ee?n:n*.666,delay:$,easing:P})].join(","),h&&h(k,O)}),Q=T(v),X=T(D),ie=T(k=>{const{duration:O,delay:M,easing:$}=He({style:x,timeout:b,easing:c},{mode:"exit"});let P;b==="auto"?(P=W.transitions.getAutoHeightDuration(k.clientHeight),w.current=P):P=O,k.style.transition=[W.transitions.create("opacity",{duration:P,delay:M}),W.transitions.create("transform",{duration:Ee?P:P*.666,delay:Ee?M:M||P*.333,easing:$})].join(","),k.style.opacity=0,k.style.transform=Se(.75),y&&y(k)}),Y=T(N),re=k=>{b==="auto"&&C.start(w.current||0,k),o&&o(H.current,k)};return i.jsx(R,{appear:s,in:u,nodeRef:H,onEnter:G,onEntered:Q,onEntering:ee,onExit:ie,onExited:Y,onExiting:X,addEndListener:re,timeout:b==="auto"?null:b,...m,children:(k,O)=>f.cloneElement(a,{style:{opacity:0,transform:Se(.75),visibility:k==="exited"&&!u?"hidden":void 0,...Et[k],...x,...a.props.style},ref:L,...O})})});je&&(je.muiSupportAuto=!0);function Ct(e={}){const{autoHideDuration:t=null,disableWindowBlurListener:l=!1,onClose:o,open:s,resumeHideDuration:a}=e,c=Ue();f.useEffect(()=>{if(!s)return;function m(C){C.defaultPrevented||C.key==="Escape"&&(o==null||o(C,"escapeKeyDown"))}return document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[s,o]);const u=Ce((m,C)=>{o==null||o(m,C)}),h=Ce(m=>{!o||m==null||c.start(m,()=>{u(null,"timeout")})});f.useEffect(()=>(s&&h(t),c.clear),[s,t,h,c]);const v=m=>{o==null||o(m,"clickaway")},E=c.clear,y=f.useCallback(()=>{t!=null&&h(a??t*.5)},[t,a,h]),N=m=>C=>{const w=m.onBlur;w==null||w(C),y()},D=m=>C=>{const w=m.onFocus;w==null||w(C),E()},x=m=>C=>{const w=m.onMouseEnter;w==null||w(C),E()},b=m=>C=>{const w=m.onMouseLeave;w==null||w(C),y()};return f.useEffect(()=>{if(!l&&s)return window.addEventListener("focus",y),window.addEventListener("blur",E),()=>{window.removeEventListener("focus",y),window.removeEventListener("blur",E)}},[l,s,y,E]),{getRootProps:(m={})=>{const C={..._e(e),..._e(m)};return{role:"presentation",...m,...C,onBlur:N(C),onFocus:D(C),onMouseEnter:x(C),onMouseLeave:b(C)}},onClickAway:v}}function kt(e){return De("MuiSnackbarContent",e)}we("MuiSnackbarContent",["root","message","action"]);const St=e=>{const{classes:t}=e;return Te({root:["root"],action:["action"],message:["message"]},kt,t)},jt=ce(xt,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(e,t)=>t.root})(Re(({theme:e})=>{const t=e.palette.mode==="light"?.8:.98,l=Ye(e.palette.background.default,t);return{...e.typography.body2,color:e.vars?e.vars.palette.SnackbarContent.color:e.palette.getContrastText(l),backgroundColor:e.vars?e.vars.palette.SnackbarContent.bg:l,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(e.vars||e).shape.borderRadius,flexGrow:1,[e.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),wt=ce("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(e,t)=>t.message})({padding:"8px 0"}),Dt=ce("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(e,t)=>t.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),Rt=f.forwardRef(function(t,l){const o=Ne({props:t,name:"MuiSnackbarContent"}),{action:s,className:a,message:c,role:u="alert",...h}=o,v=o,E=St(v);return i.jsxs(jt,{role:u,square:!0,elevation:6,className:qe(E.root,a),ownerState:v,ref:l,...h,children:[i.jsx(wt,{className:E.message,ownerState:v,children:c}),s?i.jsx(Dt,{className:E.action,ownerState:v,children:s}):null]})});function Nt(e){return De("MuiSnackbar",e)}we("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const Tt=e=>{const{classes:t,anchorOrigin:l}=e,o={root:["root",`anchorOrigin${ge(l.vertical)}${ge(l.horizontal)}`]};return Te(o,Nt,t)},Fe=ce("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:l}=e;return[t.root,t[`anchorOrigin${ge(l.anchorOrigin.vertical)}${ge(l.anchorOrigin.horizontal)}`]]}})(Re(({theme:e})=>({zIndex:(e.vars||e).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:t})=>t.anchorOrigin.vertical==="top",style:{top:8,[e.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:t})=>t.anchorOrigin.vertical!=="top",style:{bottom:8,[e.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:t})=>t.anchorOrigin.horizontal==="left",style:{justifyContent:"flex-start",[e.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:t})=>t.anchorOrigin.horizontal==="right",style:{justifyContent:"flex-end",[e.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:t})=>t.anchorOrigin.horizontal==="center",style:{[e.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),Pt=f.forwardRef(function(t,l){const o=Ne({props:t,name:"MuiSnackbar"}),s=Pe(),a={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{action:c,anchorOrigin:{vertical:u,horizontal:h}={vertical:"bottom",horizontal:"left"},autoHideDuration:v=null,children:E,className:y,ClickAwayListenerProps:N,ContentProps:D,disableWindowBlurListener:x=!1,message:b,onBlur:R,onClose:m,onFocus:C,onMouseEnter:w,onMouseLeave:W,open:H,resumeHideDuration:L,TransitionComponent:T=je,transitionDuration:ee=a,TransitionProps:{onEnter:G,onExited:Q,...X}={},...ie}=o,Y={...o,anchorOrigin:{vertical:u,horizontal:h},autoHideDuration:v,disableWindowBlurListener:x,TransitionComponent:T,transitionDuration:ee},re=Tt(Y),{getRootProps:k,onClickAway:O}=Ct({...Y}),[M,$]=f.useState(!0),P=dt({elementType:Fe,getSlotProps:k,externalForwardedProps:ie,ownerState:Y,additionalProps:{ref:l},className:[re.root,y]}),n=S=>{$(!0),Q&&Q(S)},d=(S,j)=>{$(!1),G&&G(S,j)};return!H&&M?null:i.jsx(yt,{onClickAway:O,...N,children:i.jsx(Fe,{...P,children:i.jsx(T,{appear:!0,in:H,timeout:ee,direction:u==="top"?"down":"up",onEnter:d,onExited:n,...X,children:E||i.jsx(Rt,{message:b,action:c,...D})})})})}),Ae={id:"",code:"",name:"",email:"",phone:"",citizenId:"",address:"",province:null,district:null,ward:null,status:"active",note:"",birthDay:"",gender:!0,password:"",deleted:!1},_t=()=>{const[e,t]=f.useState(Ae),[l,o]=f.useState([]),[s,a]=f.useState([]),[c,u]=f.useState([]),[h,v]=f.useState(!1),[E,y]=f.useState(!1),[N,D]=f.useState(!1),[x,b]=f.useState(!1),R=f.useRef(null),[m,C]=f.useState(!1),[w,W]=f.useState(""),H=Ke(),[L,T]=f.useState(!1);f.useEffect(()=>{ee()},[]),f.useEffect(()=>{if(e.province&&l.length>0){const n=l.find(d=>d.full_name===e.province);n?G(n.id):a([])}},[e.province,l]),f.useEffect(()=>{if(e.district&&s.length>0){const n=s.find(d=>d.full_name===e.district);n?Q(n.id):u([])}},[e.district,s]);const ee=async()=>{v(!0);try{const d=(await A.get("https://esgoo.net/api-tinhthanh/1/0.htm")).data;d.error===0&&o(d.data)}catch{}finally{v(!1)}},G=async n=>{y(!0);try{const d=await A.get(`https://esgoo.net/api-tinhthanh/2/${n}.htm`);d.data.error===0?a(d.data.data):a([])}catch{a([])}finally{y(!1)}},Q=async n=>{D(!0);try{const d=await A.get(`https://esgoo.net/api-tinhthanh/3/${n}.htm`);d.data.error===0?u(d.data.data):u([])}catch{u([])}finally{D(!1)}},X=(n,d,S)=>{d&&(n==="province"?(S.setFieldValue("province",d.full_name),S.setFieldValue("district",""),S.setFieldValue("ward",""),t(j=>({...j,province:d.full_name,district:null,ward:null})),G(d.id)):n==="district"?(S.setFieldValue("district",d.full_name),S.setFieldValue("ward",""),t(j=>({...j,district:d.full_name,ward:null})),Q(d.id)):n==="ward"&&(S.setFieldValue("ward",d.full_name),t(j=>({...j,ward:d.full_name}))))},ie=Je({name:q().required("Họ tên khách hàng là bắt buộc").min(3,"Họ và tên khách hàng phải có ít nhất 3 ký tự").max(50,"Họ và tên khách hàng không vượt quá 50 ký tự").test("no-whitespace","Họ và tên không được chứa nhiều khoảng trắng",n=>n.trim()===n&&!n.includes("  ")).test("no-special-characters","Họ và tên không được chứa ký tự đặc biệt hoặc số",n=>/^[\p{L}\s]+$/u.test(n)),email:q().email("Email không hợp lệ").required("Email là bắt buộc").test("no-whitespace","Email không được chứa khoảng trắng đầu và cuối",n=>n.trim()===n).test("email-unique","Email đã tồn tại",async n=>!(await A.get(`${me.apiPrefix}/staffs/check-email`,{params:{email:n}})).data.exists),phone:q().required("Số điện thoại là bắt buộc").matches(/(03|05|07|08|09|01[2|6|8|9])+([0-9]{8})\b/,"Số điện thoại không hợp lệ").test("phone-unique","Số điện thoại đã tồn tại",async n=>!(await A.get(`${me.apiPrefix}/staffs/check-phone`,{params:{phone:n}})).data.exists),citizenId:q().matches(/^[0-9]{12}$/,"Căn cước công dân phải có đúng 12 chữ số").required("Căn cước công dân là bắt buộc").test("citizenId-unique","Căn cước công dân đã tồn tại",async n=>!(await A.get(`${me.apiPrefix}/staffs/check-citizenId`,{params:{citizenId:n}})).data.exists),birthDay:Ze().required("Ngày sinh là bắt buộc").max(new Date,"Ngày sinh không được là tương lai").test("age-range","Nhân viên phải trong độ tuổi từ 16 đến 40",function(n){const d=te().diff(te(n),"year");return d>=16&&d<=40}),address:q().required("Số nhà là bắt buộc"),province:q().required("Tỉnh/Thành phố là bắt buộc"),district:q().required("Quận/Huyện là bắt buộc"),ward:q().required("Phường/Xã là bắt buộc"),note:q(),gender:Ve().required("Giới tính là bắt buộc")}),Y=async(n,{resetForm:d,setSubmitting:S})=>{S(!0);try{const j=l.find(g=>g.id===n.province);j&&(n.province=j.name);const K=s.find(g=>g.id===n.district);K&&(n.district=K.name);const U=c.find(g=>g.id===n.ward);U&&(n.ward=U.name);const p={...n,province:n.province,district:n.district,ward:n.ward},r=await A.post(`${me.apiPrefix}/staffs`,p);if(r.status===201){const{code:g,password:de}=r.data;t(ue=>({...ue,code:g,password:de})),Ie.success("Nhân viên đã thêm thành công! Thông tin đã gửi qua email."),d(),H("/admin/manage/staff")}}catch{Ie.error("Lỗi lưu nhân viên")}finally{S(!1)}},re=n=>{n(),t(Ae),T(!1)},k=()=>{C(!1)},O=()=>{b(!0)},M=()=>{b(!1)},$=n=>{if(n.length===8){const d=n.slice(0,2),S=n.slice(2,4);return`${n.slice(4,8)}-${S.padStart(2,"0")}-${d.padStart(2,"0")}`}return null};f.useEffect(()=>{if(x&&R.current){const n=new et("reader",{fps:10,qrbox:350},!1);return n.render(async d=>{console.log("data: ",d);const S=d.split("|");if(S.length>=6){const j=S[0],K=S[2],U=$(S[3]),p=S[4]==="Nam",g=S[5].split(",");if(!U){console.error("Invalid date format in QR code");return}const de=g[0],ue=g[3]||"";let _=null;if(ue.toLowerCase()!=""&&(_=l.find(F=>F.full_name.toLowerCase().includes(ue.toLowerCase()))),_&&(_!=null&&_.id))try{const F=await A.get(`https://esgoo.net/api-tinhthanh/2/${_.id}.htm`);if(F.status===200){a(F.data.data);const J=F.data.data.find(oe=>oe.full_name.toLowerCase().includes((g[2]||"").toLowerCase()));if(J&&J.id){const oe=await A.get(`https://esgoo.net/api-tinhthanh/3/${J.id}.htm`);if(oe.status===200){u(oe.data.data);const pe=oe.data.data.find(ve=>ve.full_name.toLowerCase().includes((g[1]||"").toLowerCase()));t(ve=>({...ve,citizenId:j,name:K,birthDay:U,address:de,province:(_==null?void 0:_.full_name)||null,district:(J==null?void 0:J.full_name)||null,ward:(pe==null?void 0:pe.full_name)||null,gender:p})),console.log(_.full_name),console.log(J.full_name),console.log(pe.full_name),T(!0)}}}}catch(F){console.error(F)}else console.error("Province not found"),T(!1),t(F=>({...F,citizenId:j,name:K,birthDay:U,address:de,province:"",district:"",ward:"",gender:p}));b(!1),n.clear()}else console.error("Invalid QR code format")},d=>{console.error(d)}),()=>{n.clear()}}},[x,l]);const P=()=>{const n=rt();return f.useEffect(()=>{n.setValues(e)},[e]),null};return i.jsx("div",{children:i.jsxs("div",{className:"bg-white p-6 shadow-md rounded-lg mb-6 w-full",children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[i.jsx("p",{className:"text-left text-xl font-bold",children:"THÊM NHÂN VIÊN"}),i.jsx(ut,{style:{display:"flex",alignItems:"center"},children:i.jsxs(xe,{color:"primary",className:"btn-outline-info",onClick:O,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[i.jsx(tt,{className:"mr-2",style:{fontSize:"24px"}}),"Quét CCCD"]})})]}),i.jsx("div",{className:`shadow-xl px-8 z-10 bg-white py-2 fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-2/6 ${x?"":"hidden"}`,children:i.jsxs("div",{className:"flex flex-col",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("label",{children:"Quét thẻ căn cước công dân"}),i.jsx("button",{onClick:M,children:i.jsx(pt,{})})]}),i.jsx("div",{children:i.jsx("div",{id:"reader",ref:R})})]})}),i.jsx(nt,{initialValues:e,validationSchema:ie,validateOnChange:!0,validateOnBlur:!0,onSubmit:Y,enableReinitialize:!0,children:({errors:n,touched:d,resetForm:S,setFieldValue:j,values:K,isSubmitting:U})=>i.jsxs(at,{children:[i.jsx(P,{}),i.jsxs(st,{children:[i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"16px"},children:[i.jsxs("div",{style:{flex:"1 1 300px",minWidth:"200px"},children:[i.jsxs(I,{asterisk:!0,label:"Họ tên nhân viên",children:[i.jsx(z,{type:"text",autoComplete:"on",name:"name",placeholder:"Nhập họ tên nhân viên...",component:ne,disabled:L,onChange:p=>{j("name",p.target.value),t(r=>({...r,name:p.target.value}))},value:e.name}),d.name&&n.name&&i.jsx("div",{style:{color:"red",fontSize:"0.875rem",marginTop:"0.25rem",minHeight:"20px"},children:n.name})]}),i.jsxs(I,{asterisk:!0,label:"Căn cước công dân",children:[i.jsx(z,{type:"text",autoComplete:"on",name:"citizenId",placeholder:"Nhập căn cước công dân...",component:ne,disabled:L,onChange:p=>{const r=p.target.value.replace(/[^0-9]/g,"");j("citizenId",r),t(g=>({...g,citizenId:r}))},onKeyPress:p=>{/[0-9]/.test(p.key)||p.preventDefault()},value:e.citizenId||""}),d.citizenId&&n.citizenId&&i.jsx("div",{style:{color:"red",fontSize:"0.875rem",marginTop:"0.25rem",minHeight:"20px"},children:n.citizenId})]}),i.jsx(I,{asterisk:!0,label:"Ngày sinh",invalid:n.birthDay&&d.birthDay,errorMessage:n.birthDay,children:i.jsx(it,{inputtable:!0,inputtableBlurClose:!1,placeholder:"Chọn ngày sinh...",value:e.birthDay?te(e.birthDay,"YYYY-MM-DD").toDate():null,disabled:L,onChange:p=>{if(p){const r=te(p).format("YYYY-MM-DD");j("birthDay",r),t(g=>({...g,birthDay:r}))}else j("birthDay",""),t(r=>({...r,birthDay:""}))},disableDate:p=>te(p).isAfter(te().endOf("day"))})}),i.jsx(I,{asterisk:!0,label:"Giới tính",children:i.jsx(z,{name:"gender",children:({field:p,form:r})=>i.jsxs(i.Fragment,{children:[i.jsx(Me,{className:"mr-4",value:"Nam",checked:e.gender===!0,onChange:()=>{r.setFieldValue("gender",!0),t(g=>({...g,gender:!0}))},disabled:L,children:"Nam"}),i.jsx(Me,{value:"Nữ",checked:e.gender===!1,onChange:()=>{r.setFieldValue("gender",!1),t(g=>({...g,gender:!1}))},disabled:L,children:"Nữ"})]})})})]}),i.jsxs("div",{style:{flex:"1 1 300px",minWidth:"200px"},children:[i.jsx(I,{asterisk:!0,label:"Tỉnh/Thành phố",invalid:n.province&&d.province,errorMessage:n.province,children:i.jsx(z,{name:"province",children:({form:p})=>i.jsx(be,{isDisabled:h||L,value:l.find(r=>r.full_name===e.province)||null,placeholder:"Chọn tỉnh/thành phố...",getOptionLabel:r=>r.full_name,getOptionValue:r=>r.full_name,options:l,onChange:r=>{X("province",r,p),p.setFieldValue("province",r?r.full_name:""),t(g=>({...g,province:r?r.full_name:""}))},onBlur:()=>p.setFieldTouched("province",!0)})})}),i.jsx(I,{asterisk:!0,label:"Quận/huyện",invalid:n.district&&d.district,errorMessage:n.district,children:i.jsx(z,{name:"district",children:({form:p})=>i.jsx(be,{isDisabled:L,value:s.find(r=>r.full_name===e.district)||null,placeholder:"Chọn quận/huyện...",getOptionLabel:r=>r.full_name,getOptionValue:r=>r.full_name,options:s,onChange:r=>{X("district",r,p),p.setFieldValue("district",r?r.full_name:""),t(g=>({...g,district:r?r.full_name:""}))},onBlur:()=>p.setFieldTouched("district",!0)})})}),i.jsx(I,{asterisk:!0,label:"Xã/phường/thị trấn",invalid:n.ward&&d.ward,errorMessage:n.ward,children:i.jsx(z,{name:"ward",children:({form:p})=>i.jsx(be,{isDisabled:L,value:c.find(r=>r.full_name===e.ward)||null,placeholder:"Chọn xã/phường/thị trấn...",getOptionLabel:r=>r.full_name,getOptionValue:r=>r.full_name,options:c,onChange:r=>{X("ward",r,p),p.setFieldValue("ward",r?r.full_name:""),t(g=>({...g,ward:r?r.full_name:""}))},onBlur:()=>p.setFieldTouched("ward",!0)})})}),i.jsxs(I,{asterisk:!0,label:"Số đường/số nhà",invalid:!!n.address&&d.address,children:[i.jsx(z,{type:"text",autoComplete:"on",name:"address",placeholder:"Nhập số đường/số nhà...",component:ne,disabled:L&&e.address!=="null"&&e.address!=="null null",onChange:p=>{j("address",p.target.value),t(r=>({...r,address:p.target.value}))},value:e.address}),d.address&&n.address&&i.jsx("div",{style:{color:"red",fontSize:"0.875rem",marginTop:"0.25rem",minHeight:"20px"},children:n.address})]})]}),i.jsxs("div",{style:{flex:"1 1 300px",minWidth:"200px"},children:[i.jsxs(I,{asterisk:!0,label:"Số điện thoại",children:[i.jsx(z,{type:"text",autoComplete:"on",name:"phone",placeholder:"Nhập số điện thoại...",component:ne,onChange:p=>{const r=p.target.value.replace(/[^0-9]/g,"");j("phone",r),t(g=>({...g,phone:r}))},onKeyPress:p=>{/[0-9]/.test(p.key)||p.preventDefault()},value:e.phone||""}),d.phone&&n.phone&&i.jsx("div",{style:{color:"red",fontSize:"0.875rem",marginTop:"0.25rem",minHeight:"20px"},children:n.phone})]}),i.jsxs(I,{asterisk:!0,label:"Email",children:[i.jsx(z,{type:"text",autoComplete:"on",name:"email",placeholder:"Nhập email...",component:ne,onChange:p=>{j("email",p.target.value),t(r=>({...r,email:p.target.value}))},value:e.email}),d.email&&n.email&&i.jsx("div",{style:{color:"red",fontSize:"0.875rem",marginTop:"0.25rem",minHeight:"20px"},children:n.email})]}),i.jsx(I,{label:"Ghi chú",children:i.jsx(z,{as:ne,name:"note",placeholder:"Nhập ghi chú",textArea:!0,onChange:p=>{j("note",p.target.value),t(r=>({...r,note:p.target.value}))},value:e.note,style:{height:"150px"}})})]})]}),i.jsxs("div",{style:{marginTop:"1rem",display:"flex",alignItems:"center"},children:[i.jsxs(xe,{type:"submit",className:"flex items-center justify-center",variant:"solid",color:"blue-600",disabled:U,children:[i.jsx(ot,{className:"mr-2",style:{fontSize:"20px"}}),"Lưu"]}),i.jsxs(xe,{type:"button",onClick:()=>re(S),className:"flex items-center justify-center",style:{height:"40px",width:"110px",lineHeight:"40px",padding:"0",fontSize:"15px",marginLeft:"1rem"},children:[i.jsx(lt,{className:"mr-2",style:{fontSize:"18px"}}),"Đặt lại"]})]})]})]})}),i.jsx(Pt,{open:m,autoHideDuration:3e3,onClose:k,message:w})]})})};export{_t as default};
