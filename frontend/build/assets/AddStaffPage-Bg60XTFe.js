import{r as h,J as Ge,j as i,cz as he,cA as Qe,bb as fe,cB as je,cC as we,cD as ce,cE as De,cF as Re,cG as Ae,cH as Le,cI as Oe,cJ as Ne,cK as Xe,cL as me,aH as Ye,aD as A,at as Ke,au as q,cg as Je,bM as te,cy as Ze,cM as Ve,B as ve,cN as et,ax as tt,ay as nt,az as at,aA as I,aB as z,aC as ne,ca as st,bf as Pe,ci as xe,aE as Me,cO as it}from"./index-R95oJY3P.js";import{I as rt}from"./index.esm-Bm-zrEPt.js";import{R as ot}from"./index.esm-D8UzwFGg.js";import{_ as lt,T as qe,u as Te,a as Be,b as Ee,o as be,c as We,e as Ie,d as ct,B as dt}from"./Box-uBNEvwtl.js";function Ue(e){var t;return parseInt(h.version,10)>=19?((t=e==null?void 0:e.props)==null?void 0:t.ref)||null:(e==null?void 0:e.ref)||null}const ut=Ge(i.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"CloseOutlined"),_e={disabled:!1};var pt=function(t){return t.scrollTop},le="unmounted",Z="exited",V="entering",se="entered",Ce="exiting",B=function(e){lt(t,e);function t(o,s){var a;a=e.call(this,o,s)||this;var c=s,u=c&&!c.isMounting?o.enter:o.appear,f;return a.appearStatus=null,o.in?u?(f=Z,a.appearStatus=V):f=se:o.unmountOnExit||o.mountOnEnter?f=le:f=Z,a.state={status:f},a.nextCallback=null,a}t.getDerivedStateFromProps=function(s,a){var c=s.in;return c&&a.status===le?{status:Z}:null};var l=t.prototype;return l.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},l.componentDidUpdate=function(s){var a=null;if(s!==this.props){var c=this.state.status;this.props.in?c!==V&&c!==se&&(a=V):(c===V||c===se)&&(a=Ce)}this.updateStatus(!1,a)},l.componentWillUnmount=function(){this.cancelNextCallback()},l.getTimeouts=function(){var s=this.props.timeout,a,c,u;return a=c=u=s,s!=null&&typeof s!="number"&&(a=s.exit,c=s.enter,u=s.appear!==void 0?s.appear:c),{exit:a,enter:c,appear:u}},l.updateStatus=function(s,a){if(s===void 0&&(s=!1),a!==null)if(this.cancelNextCallback(),a===V){if(this.props.unmountOnExit||this.props.mountOnEnter){var c=this.props.nodeRef?this.props.nodeRef.current:he.findDOMNode(this);c&&pt(c)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Z&&this.setState({status:le})},l.performEnter=function(s){var a=this,c=this.props.enter,u=this.context?this.context.isMounting:s,f=this.props.nodeRef?[u]:[he.findDOMNode(this),u],v=f[0],E=f[1],y=this.getTimeouts(),N=u?y.appear:y.enter;if(!s&&!c||_e.disabled){this.safeSetState({status:se},function(){a.props.onEntered(v)});return}this.props.onEnter(v,E),this.safeSetState({status:V},function(){a.props.onEntering(v,E),a.onTransitionEnd(N,function(){a.safeSetState({status:se},function(){a.props.onEntered(v,E)})})})},l.performExit=function(){var s=this,a=this.props.exit,c=this.getTimeouts(),u=this.props.nodeRef?void 0:he.findDOMNode(this);if(!a||_e.disabled){this.safeSetState({status:Z},function(){s.props.onExited(u)});return}this.props.onExit(u),this.safeSetState({status:Ce},function(){s.props.onExiting(u),s.onTransitionEnd(c.exit,function(){s.safeSetState({status:Z},function(){s.props.onExited(u)})})})},l.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},l.safeSetState=function(s,a){a=this.setNextCallback(a),this.setState(s,a)},l.setNextCallback=function(s){var a=this,c=!0;return this.nextCallback=function(u){c&&(c=!1,a.nextCallback=null,s(u))},this.nextCallback.cancel=function(){c=!1},this.nextCallback},l.onTransitionEnd=function(s,a){this.setNextCallback(a);var c=this.props.nodeRef?this.props.nodeRef.current:he.findDOMNode(this),u=s==null&&!this.props.addEndListener;if(!c||u){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var f=this.props.nodeRef?[this.nextCallback]:[c,this.nextCallback],v=f[0],E=f[1];this.props.addEndListener(v,E)}s!=null&&setTimeout(this.nextCallback,s)},l.render=function(){var s=this.state.status;if(s===le)return null;var a=this.props,c=a.children;a.in,a.mountOnEnter,a.unmountOnExit,a.appear,a.enter,a.exit,a.timeout,a.addEndListener,a.onEnter,a.onEntering,a.onEntered,a.onExit,a.onExiting,a.onExited,a.nodeRef;var u=Qe(a,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return fe.createElement(qe.Provider,{value:null},typeof c=="function"?c(s,u):fe.cloneElement(fe.Children.only(c),u))},t}(fe.Component);B.contextType=qe;B.propTypes={};function ae(){}B.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:ae,onEntering:ae,onEntered:ae,onExit:ae,onExiting:ae,onExited:ae};B.UNMOUNTED=le;B.EXITED=Z;B.ENTERING=V;B.ENTERED=se;B.EXITING=Ce;const ht=e=>e.scrollTop;function ze(e,t){const{timeout:l,easing:o,style:s={}}=e;return{duration:s.transitionDuration??(typeof l=="number"?l:l[t.mode]||0),easing:s.transitionTimingFunction??(typeof o=="object"?o[t.mode]:o),delay:s.transitionDelay}}function ft(e){return we("MuiPaper",e)}je("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const mt=e=>{const{square:t,elevation:l,variant:o,classes:s}=e,a={root:["root",o,!t&&"rounded",o==="elevation"&&`elevation${l}`]};return Ne(a,ft,s)},gt=ce("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:l}=e;return[t.root,t[l.variant],!l.square&&t.rounded,l.variant==="elevation"&&t[`elevation${l.elevation}`]]}})(De(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow"),variants:[{props:({ownerState:t})=>!t.square,style:{borderRadius:e.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(e.vars||e).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),vt=h.forwardRef(function(t,l){var D;const o=Re({props:t,name:"MuiPaper"}),s=Te(),{className:a,component:c="div",elevation:u=1,square:f=!1,variant:v="elevation",...E}=o,y={...o,component:c,elevation:u,square:f,variant:v},N=mt(y);return i.jsx(gt,{as:c,ownerState:y,className:Ae(N.root,a),ref:l,...E,style:{...v==="elevation"&&{"--Paper-shadow":(s.vars||s).shadows[u],...s.vars&&{"--Paper-overlay":(D=s.vars.overlays)==null?void 0:D[u]},...!s.vars&&s.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${Le("#fff",Oe(u))}, ${Le("#fff",Oe(u))})`}},...E.style}})});function He(e){return e.substring(2).toLowerCase()}function xt(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}function bt(e){const{children:t,disableReactTree:l=!1,mouseEvent:o="onClick",onClickAway:s,touchEvent:a="onTouchEnd"}=e,c=h.useRef(!1),u=h.useRef(null),f=h.useRef(!1),v=h.useRef(!1);h.useEffect(()=>(setTimeout(()=>{f.current=!0},0),()=>{f.current=!1}),[]);const E=Be(Ue(t),u),y=Ee(x=>{const b=v.current;v.current=!1;const R=be(u.current);if(!f.current||!u.current||"clientX"in x&&xt(x,R))return;if(c.current){c.current=!1;return}let m;x.composedPath?m=x.composedPath().includes(u.current):m=!R.documentElement.contains(x.target)||u.current.contains(x.target),!m&&(l||!b)&&s(x)}),N=x=>b=>{v.current=!0;const R=t.props[x];R&&R(b)},D={ref:E};return a!==!1&&(D[a]=N(a)),h.useEffect(()=>{if(a!==!1){const x=He(a),b=be(u.current),R=()=>{c.current=!0};return b.addEventListener(x,y),b.addEventListener("touchmove",R),()=>{b.removeEventListener(x,y),b.removeEventListener("touchmove",R)}}},[y,a]),o!==!1&&(D[o]=N(o)),h.useEffect(()=>{if(o!==!1){const x=He(o),b=be(u.current);return b.addEventListener(x,y),()=>{b.removeEventListener(x,y)}}},[y,o]),i.jsx(h.Fragment,{children:h.cloneElement(t,D)})}function ke(e){return`scale(${e}, ${e**2})`}const yt={entering:{opacity:1,transform:ke(1)},entered:{opacity:1,transform:"none"}},ye=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Se=h.forwardRef(function(t,l){const{addEndListener:o,appear:s=!0,children:a,easing:c,in:u,onEnter:f,onEntered:v,onEntering:E,onExit:y,onExited:N,onExiting:D,style:x,timeout:b="auto",TransitionComponent:R=B,...m}=t,C=We(),w=h.useRef(),W=Te(),H=h.useRef(null),O=Be(H,Ue(a),l),T=k=>P=>{if(k){const M=H.current;P===void 0?k(M):k(M,P)}},ee=T(E),G=T((k,P)=>{ht(k);const{duration:M,delay:F,easing:L}=ze({style:x,timeout:b,easing:c},{mode:"enter"});let n;b==="auto"?(n=W.transitions.getAutoHeightDuration(k.clientHeight),w.current=n):n=M,k.style.transition=[W.transitions.create("opacity",{duration:n,delay:F}),W.transitions.create("transform",{duration:ye?n:n*.666,delay:F,easing:L})].join(","),f&&f(k,P)}),Q=T(v),X=T(D),ie=T(k=>{const{duration:P,delay:M,easing:F}=ze({style:x,timeout:b,easing:c},{mode:"exit"});let L;b==="auto"?(L=W.transitions.getAutoHeightDuration(k.clientHeight),w.current=L):L=P,k.style.transition=[W.transitions.create("opacity",{duration:L,delay:M}),W.transitions.create("transform",{duration:ye?L:L*.666,delay:ye?M:M||L*.333,easing:F})].join(","),k.style.opacity=0,k.style.transform=ke(.75),y&&y(k)}),Y=T(N),re=k=>{b==="auto"&&C.start(w.current||0,k),o&&o(H.current,k)};return i.jsx(R,{appear:s,in:u,nodeRef:H,onEnter:G,onEntered:Q,onEntering:ee,onExit:ie,onExited:Y,onExiting:X,addEndListener:re,timeout:b==="auto"?null:b,...m,children:(k,P)=>h.cloneElement(a,{style:{opacity:0,transform:ke(.75),visibility:k==="exited"&&!u?"hidden":void 0,...yt[k],...x,...a.props.style},ref:O,...P})})});Se&&(Se.muiSupportAuto=!0);function Et(e={}){const{autoHideDuration:t=null,disableWindowBlurListener:l=!1,onClose:o,open:s,resumeHideDuration:a}=e,c=We();h.useEffect(()=>{if(!s)return;function m(C){C.defaultPrevented||C.key==="Escape"&&(o==null||o(C,"escapeKeyDown"))}return document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[s,o]);const u=Ee((m,C)=>{o==null||o(m,C)}),f=Ee(m=>{!o||m==null||c.start(m,()=>{u(null,"timeout")})});h.useEffect(()=>(s&&f(t),c.clear),[s,t,f,c]);const v=m=>{o==null||o(m,"clickaway")},E=c.clear,y=h.useCallback(()=>{t!=null&&f(a??t*.5)},[t,a,f]),N=m=>C=>{const w=m.onBlur;w==null||w(C),y()},D=m=>C=>{const w=m.onFocus;w==null||w(C),E()},x=m=>C=>{const w=m.onMouseEnter;w==null||w(C),E()},b=m=>C=>{const w=m.onMouseLeave;w==null||w(C),y()};return h.useEffect(()=>{if(!l&&s)return window.addEventListener("focus",y),window.addEventListener("blur",E),()=>{window.removeEventListener("focus",y),window.removeEventListener("blur",E)}},[l,s,y,E]),{getRootProps:(m={})=>{const C={...Ie(e),...Ie(m)};return{role:"presentation",...m,...C,onBlur:N(C),onFocus:D(C),onMouseEnter:x(C),onMouseLeave:b(C)}},onClickAway:v}}function Ct(e){return we("MuiSnackbarContent",e)}je("MuiSnackbarContent",["root","message","action"]);const kt=e=>{const{classes:t}=e;return Ne({root:["root"],action:["action"],message:["message"]},Ct,t)},St=ce(vt,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(e,t)=>t.root})(De(({theme:e})=>{const t=e.palette.mode==="light"?.8:.98,l=Xe(e.palette.background.default,t);return{...e.typography.body2,color:e.vars?e.vars.palette.SnackbarContent.color:e.palette.getContrastText(l),backgroundColor:e.vars?e.vars.palette.SnackbarContent.bg:l,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(e.vars||e).shape.borderRadius,flexGrow:1,[e.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),jt=ce("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(e,t)=>t.message})({padding:"8px 0"}),wt=ce("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(e,t)=>t.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),Dt=h.forwardRef(function(t,l){const o=Re({props:t,name:"MuiSnackbarContent"}),{action:s,className:a,message:c,role:u="alert",...f}=o,v=o,E=kt(v);return i.jsxs(St,{role:u,square:!0,elevation:6,className:Ae(E.root,a),ownerState:v,ref:l,...f,children:[i.jsx(jt,{className:E.message,ownerState:v,children:c}),s?i.jsx(wt,{className:E.action,ownerState:v,children:s}):null]})});function Rt(e){return we("MuiSnackbar",e)}je("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const Nt=e=>{const{classes:t,anchorOrigin:l}=e,o={root:["root",`anchorOrigin${me(l.vertical)}${me(l.horizontal)}`]};return Ne(o,Rt,t)},Fe=ce("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:l}=e;return[t.root,t[`anchorOrigin${me(l.anchorOrigin.vertical)}${me(l.anchorOrigin.horizontal)}`]]}})(De(({theme:e})=>({zIndex:(e.vars||e).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:t})=>t.anchorOrigin.vertical==="top",style:{top:8,[e.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:t})=>t.anchorOrigin.vertical!=="top",style:{bottom:8,[e.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:t})=>t.anchorOrigin.horizontal==="left",style:{justifyContent:"flex-start",[e.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:t})=>t.anchorOrigin.horizontal==="right",style:{justifyContent:"flex-end",[e.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:t})=>t.anchorOrigin.horizontal==="center",style:{[e.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),Tt=h.forwardRef(function(t,l){const o=Re({props:t,name:"MuiSnackbar"}),s=Te(),a={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{action:c,anchorOrigin:{vertical:u,horizontal:f}={vertical:"bottom",horizontal:"left"},autoHideDuration:v=null,children:E,className:y,ClickAwayListenerProps:N,ContentProps:D,disableWindowBlurListener:x=!1,message:b,onBlur:R,onClose:m,onFocus:C,onMouseEnter:w,onMouseLeave:W,open:H,resumeHideDuration:O,TransitionComponent:T=Se,transitionDuration:ee=a,TransitionProps:{onEnter:G,onExited:Q,...X}={},...ie}=o,Y={...o,anchorOrigin:{vertical:u,horizontal:f},autoHideDuration:v,disableWindowBlurListener:x,TransitionComponent:T,transitionDuration:ee},re=Nt(Y),{getRootProps:k,onClickAway:P}=Et({...Y}),[M,F]=h.useState(!0),L=ct({elementType:Fe,getSlotProps:k,externalForwardedProps:ie,ownerState:Y,additionalProps:{ref:l},className:[re.root,y]}),n=S=>{F(!0),Q&&Q(S)},d=(S,j)=>{F(!1),G&&G(S,j)};return!H&&M?null:i.jsx(bt,{onClickAway:P,...N,children:i.jsx(Fe,{...L,children:i.jsx(T,{appear:!0,in:H,timeout:ee,direction:u==="top"?"down":"up",onEnter:d,onExited:n,...X,children:E||i.jsx(Dt,{message:b,action:c,...D})})})})}),$e={id:"",code:"",name:"",email:"",phone:"",citizenId:"",address:"",province:null,district:null,ward:null,status:"active",note:"",birthDay:"",gender:!0,password:"",deleted:!1},It=()=>{const[e,t]=h.useState($e),[l,o]=h.useState([]),[s,a]=h.useState([]),[c,u]=h.useState([]),[f,v]=h.useState(!1),[E,y]=h.useState(!1),[N,D]=h.useState(!1),[x,b]=h.useState(!1),R=h.useRef(null),[m,C]=h.useState(!1),[w,W]=h.useState(""),H=Ye(),[O,T]=h.useState(!1);h.useEffect(()=>{ee()},[]),h.useEffect(()=>{if(e.province&&l.length>0){const n=l.find(d=>d.full_name===e.province);n?G(n.id):a([])}},[e.province,l]),h.useEffect(()=>{if(e.district&&s.length>0){const n=s.find(d=>d.full_name===e.district);n?Q(n.id):u([])}},[e.district,s]);const ee=async()=>{v(!0);try{const d=(await A.get("https://esgoo.net/api-tinhthanh/1/0.htm")).data;d.error===0&&o(d.data)}catch{}finally{v(!1)}},G=async n=>{y(!0);try{const d=await A.get(`https://esgoo.net/api-tinhthanh/2/${n}.htm`);d.data.error===0?a(d.data.data):a([])}catch{a([])}finally{y(!1)}},Q=async n=>{D(!0);try{const d=await A.get(`https://esgoo.net/api-tinhthanh/3/${n}.htm`);d.data.error===0?u(d.data.data):u([])}catch{u([])}finally{D(!1)}},X=(n,d,S)=>{d&&(n==="province"?(S.setFieldValue("province",d.full_name),S.setFieldValue("district",""),S.setFieldValue("ward",""),t(j=>({...j,province:d.full_name,district:null,ward:null})),G(d.id)):n==="district"?(S.setFieldValue("district",d.full_name),S.setFieldValue("ward",""),t(j=>({...j,district:d.full_name,ward:null})),Q(d.id)):n==="ward"&&(S.setFieldValue("ward",d.full_name),t(j=>({...j,ward:d.full_name}))))},ie=Ke({name:q().required("Họ tên khách hàng là bắt buộc").min(3,"Họ và tên khách hàng phải có ít nhất 3 ký tự").max(50,"Họ và tên khách hàng không vượt quá 50 ký tự").test("no-whitespace","Họ và tên không được chứa nhiều khoảng trắng",n=>n.trim()===n&&!n.includes("  ")).test("no-special-characters","Họ và tên không được chứa ký tự đặc biệt hoặc số",n=>/^[\p{L}\s]+$/u.test(n)),email:q().email("Email không hợp lệ").required("Email là bắt buộc").test("no-whitespace","Email không được chứa khoảng trắng đầu và cuối",n=>n.trim()===n).test("email-unique","Email đã tồn tại",async n=>!(await A.get("http://localhost:8080/api/v1/staffs/check-email",{params:{email:n}})).data.exists),phone:q().required("Số điện thoại là bắt buộc").matches(/(03|05|07|08|09|01[2|6|8|9])+([0-9]{8})\b/,"Số điện thoại không hợp lệ").test("phone-unique","Số điện thoại đã tồn tại",async n=>!(await A.get("http://localhost:8080/api/v1/staffs/check-phone",{params:{phone:n}})).data.exists),citizenId:q().matches(/^[0-9]{12}$/,"Căn cước công dân phải có đúng 12 chữ số").required("Căn cước công dân là bắt buộc").test("citizenId-unique","Căn cước công dân đã tồn tại",async n=>!(await A.get("http://localhost:8080/api/v1/staffs/check-citizenId",{params:{citizenId:n}})).data.exists),birthDay:Je().required("Ngày sinh là bắt buộc").max(new Date,"Ngày sinh không được là tương lai").test("age-range","Nhân viên phải trong độ tuổi từ 16 đến 40",function(n){const d=te().diff(te(n),"year");return d>=16&&d<=40}),address:q().required("Số nhà là bắt buộc"),province:q().required("Tỉnh/Thành phố là bắt buộc"),district:q().required("Quận/Huyện là bắt buộc"),ward:q().required("Phường/Xã là bắt buộc"),note:q(),gender:Ze().required("Giới tính là bắt buộc")}),Y=async(n,{resetForm:d,setSubmitting:S})=>{S(!0);try{const j=l.find(g=>g.id===n.province);j&&(n.province=j.name);const K=s.find(g=>g.id===n.district);K&&(n.district=K.name);const U=c.find(g=>g.id===n.ward);U&&(n.ward=U.name);const p={...n,province:n.province,district:n.district,ward:n.ward},r=await A.post("http://localhost:8080/api/v1/staffs",p);if(r.status===201){const{code:g,password:de}=r.data;t(ue=>({...ue,code:g,password:de})),Me.success("Nhân viên đã thêm thành công! Thông tin đã gửi qua email."),d(),H("/admin/manage/staff")}}catch{Me.error("Lỗi lưu nhân viên")}finally{S(!1)}},re=n=>{n(),t($e),T(!1)},k=()=>{C(!1)},P=()=>{b(!0)},M=()=>{b(!1)},F=n=>{if(n.length===8){const d=n.slice(0,2),S=n.slice(2,4);return`${n.slice(4,8)}-${S.padStart(2,"0")}-${d.padStart(2,"0")}`}return null};h.useEffect(()=>{if(x&&R.current){const n=new Ve("reader",{fps:10,qrbox:350},!1);return n.render(async d=>{console.log("data: ",d);const S=d.split("|");if(S.length>=6){const j=S[0],K=S[2],U=F(S[3]),p=S[4]==="Nam",g=S[5].split(",");if(!U){console.error("Invalid date format in QR code");return}const de=g[0],ue=g[3]||"";let _=null;if(ue.toLowerCase()!=""&&(_=l.find($=>$.full_name.toLowerCase().includes(ue.toLowerCase()))),_&&(_!=null&&_.id))try{const $=await A.get(`https://esgoo.net/api-tinhthanh/2/${_.id}.htm`);if($.status===200){a($.data.data);const J=$.data.data.find(oe=>oe.full_name.toLowerCase().includes((g[2]||"").toLowerCase()));if(J&&J.id){const oe=await A.get(`https://esgoo.net/api-tinhthanh/3/${J.id}.htm`);if(oe.status===200){u(oe.data.data);const pe=oe.data.data.find(ge=>ge.full_name.toLowerCase().includes((g[1]||"").toLowerCase()));t(ge=>({...ge,citizenId:j,name:K,birthDay:U,address:de,province:(_==null?void 0:_.full_name)||null,district:(J==null?void 0:J.full_name)||null,ward:(pe==null?void 0:pe.full_name)||null,gender:p})),console.log(_.full_name),console.log(J.full_name),console.log(pe.full_name),T(!0)}}}}catch($){console.error($)}else console.error("Province not found"),T(!1),t($=>({...$,citizenId:j,name:K,birthDay:U,address:de,province:"",district:"",ward:"",gender:p}));b(!1),n.clear()}else console.error("Invalid QR code format")},d=>{console.error(d)}),()=>{n.clear()}}},[x,l]);const L=()=>{const n=it();return h.useEffect(()=>{n.setValues(e)},[e]),null};return i.jsx("div",{children:i.jsxs("div",{className:"bg-white p-6 shadow-md rounded-lg mb-6 w-full",children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[i.jsx("p",{className:"text-left text-xl font-bold",children:"THÊM NHÂN VIÊN"}),i.jsx(dt,{style:{display:"flex",alignItems:"center"},children:i.jsxs(ve,{color:"primary",className:"btn-outline-info",onClick:P,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[i.jsx(et,{className:"mr-2",style:{fontSize:"24px"}}),"Quét CCCD"]})})]}),i.jsx("div",{className:`shadow-xl px-8 z-10 bg-white py-2 fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-2/6 ${x?"":"hidden"}`,children:i.jsxs("div",{className:"flex flex-col",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("label",{children:"Quét thẻ căn cước công dân"}),i.jsx("button",{onClick:M,children:i.jsx(ut,{})})]}),i.jsx("div",{children:i.jsx("div",{id:"reader",ref:R})})]})}),i.jsx(tt,{initialValues:e,validationSchema:ie,validateOnChange:!0,validateOnBlur:!0,onSubmit:Y,enableReinitialize:!0,children:({errors:n,touched:d,resetForm:S,setFieldValue:j,values:K,isSubmitting:U})=>i.jsxs(nt,{children:[i.jsx(L,{}),i.jsxs(at,{children:[i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"16px"},children:[i.jsxs("div",{style:{flex:"1 1 300px",minWidth:"200px"},children:[i.jsxs(I,{asterisk:!0,label:"Họ tên nhân viên",children:[i.jsx(z,{type:"text",autoComplete:"on",name:"name",placeholder:"Nhập họ tên nhân viên...",component:ne,disabled:O,onChange:p=>{j("name",p.target.value),t(r=>({...r,name:p.target.value}))},value:e.name}),d.name&&n.name&&i.jsx("div",{style:{color:"red",fontSize:"0.875rem",marginTop:"0.25rem",minHeight:"20px"},children:n.name})]}),i.jsxs(I,{asterisk:!0,label:"Căn cước công dân",children:[i.jsx(z,{type:"text",autoComplete:"on",name:"citizenId",placeholder:"Nhập căn cước công dân...",component:ne,disabled:O,onChange:p=>{const r=p.target.value.replace(/[^0-9]/g,"");j("citizenId",r),t(g=>({...g,citizenId:r}))},onKeyPress:p=>{/[0-9]/.test(p.key)||p.preventDefault()},value:e.citizenId||""}),d.citizenId&&n.citizenId&&i.jsx("div",{style:{color:"red",fontSize:"0.875rem",marginTop:"0.25rem",minHeight:"20px"},children:n.citizenId})]}),i.jsx(I,{asterisk:!0,label:"Ngày sinh",invalid:n.birthDay&&d.birthDay,errorMessage:n.birthDay,children:i.jsx(st,{inputtable:!0,inputtableBlurClose:!1,placeholder:"Chọn ngày sinh...",value:e.birthDay?te(e.birthDay,"YYYY-MM-DD").toDate():null,disabled:O,onChange:p=>{if(p){const r=te(p).format("YYYY-MM-DD");j("birthDay",r),t(g=>({...g,birthDay:r}))}else j("birthDay",""),t(r=>({...r,birthDay:""}))},disableDate:p=>te(p).isAfter(te().endOf("day"))})}),i.jsx(I,{asterisk:!0,label:"Giới tính",children:i.jsx(z,{name:"gender",children:({field:p,form:r})=>i.jsxs(i.Fragment,{children:[i.jsx(Pe,{className:"mr-4",value:"Nam",checked:e.gender===!0,onChange:()=>{r.setFieldValue("gender",!0),t(g=>({...g,gender:!0}))},disabled:O,children:"Nam"}),i.jsx(Pe,{value:"Nữ",checked:e.gender===!1,onChange:()=>{r.setFieldValue("gender",!1),t(g=>({...g,gender:!1}))},disabled:O,children:"Nữ"})]})})})]}),i.jsxs("div",{style:{flex:"1 1 300px",minWidth:"200px"},children:[i.jsx(I,{asterisk:!0,label:"Tỉnh/Thành phố",invalid:n.province&&d.province,errorMessage:n.province,children:i.jsx(z,{name:"province",children:({form:p})=>i.jsx(xe,{isDisabled:f||O,value:l.find(r=>r.full_name===e.province)||null,placeholder:"Chọn tỉnh/thành phố...",getOptionLabel:r=>r.full_name,getOptionValue:r=>r.full_name,options:l,onChange:r=>{X("province",r,p),p.setFieldValue("province",r?r.full_name:""),t(g=>({...g,province:r?r.full_name:""}))},onBlur:()=>p.setFieldTouched("province",!0)})})}),i.jsx(I,{asterisk:!0,label:"Quận/huyện",invalid:n.district&&d.district,errorMessage:n.district,children:i.jsx(z,{name:"district",children:({form:p})=>i.jsx(xe,{isDisabled:O,value:s.find(r=>r.full_name===e.district)||null,placeholder:"Chọn quận/huyện...",getOptionLabel:r=>r.full_name,getOptionValue:r=>r.full_name,options:s,onChange:r=>{X("district",r,p),p.setFieldValue("district",r?r.full_name:""),t(g=>({...g,district:r?r.full_name:""}))},onBlur:()=>p.setFieldTouched("district",!0)})})}),i.jsx(I,{asterisk:!0,label:"Xã/phường/thị trấn",invalid:n.ward&&d.ward,errorMessage:n.ward,children:i.jsx(z,{name:"ward",children:({form:p})=>i.jsx(xe,{isDisabled:O,value:c.find(r=>r.full_name===e.ward)||null,placeholder:"Chọn xã/phường/thị trấn...",getOptionLabel:r=>r.full_name,getOptionValue:r=>r.full_name,options:c,onChange:r=>{X("ward",r,p),p.setFieldValue("ward",r?r.full_name:""),t(g=>({...g,ward:r?r.full_name:""}))},onBlur:()=>p.setFieldTouched("ward",!0)})})}),i.jsxs(I,{asterisk:!0,label:"Số đường/số nhà",invalid:!!n.address&&d.address,children:[i.jsx(z,{type:"text",autoComplete:"on",name:"address",placeholder:"Nhập số đường/số nhà...",component:ne,disabled:O&&e.address!=="null"&&e.address!=="null null",onChange:p=>{j("address",p.target.value),t(r=>({...r,address:p.target.value}))},value:e.address}),d.address&&n.address&&i.jsx("div",{style:{color:"red",fontSize:"0.875rem",marginTop:"0.25rem",minHeight:"20px"},children:n.address})]})]}),i.jsxs("div",{style:{flex:"1 1 300px",minWidth:"200px"},children:[i.jsxs(I,{asterisk:!0,label:"Số điện thoại",children:[i.jsx(z,{type:"text",autoComplete:"on",name:"phone",placeholder:"Nhập số điện thoại...",component:ne,onChange:p=>{const r=p.target.value.replace(/[^0-9]/g,"");j("phone",r),t(g=>({...g,phone:r}))},onKeyPress:p=>{/[0-9]/.test(p.key)||p.preventDefault()},value:e.phone||""}),d.phone&&n.phone&&i.jsx("div",{style:{color:"red",fontSize:"0.875rem",marginTop:"0.25rem",minHeight:"20px"},children:n.phone})]}),i.jsxs(I,{asterisk:!0,label:"Email",children:[i.jsx(z,{type:"text",autoComplete:"on",name:"email",placeholder:"Nhập email...",component:ne,onChange:p=>{j("email",p.target.value),t(r=>({...r,email:p.target.value}))},value:e.email}),d.email&&n.email&&i.jsx("div",{style:{color:"red",fontSize:"0.875rem",marginTop:"0.25rem",minHeight:"20px"},children:n.email})]}),i.jsx(I,{label:"Ghi chú",children:i.jsx(z,{as:ne,name:"note",placeholder:"Nhập ghi chú",textArea:!0,onChange:p=>{j("note",p.target.value),t(r=>({...r,note:p.target.value}))},value:e.note,style:{height:"150px"}})})]})]}),i.jsxs("div",{style:{marginTop:"1rem",display:"flex",alignItems:"center"},children:[i.jsxs(ve,{type:"submit",className:"flex items-center justify-center",variant:"solid",color:"blue-600",disabled:U,children:[i.jsx(rt,{className:"mr-2",style:{fontSize:"20px"}}),"Lưu"]}),i.jsxs(ve,{type:"button",onClick:()=>re(S),className:"flex items-center justify-center",style:{height:"40px",width:"110px",lineHeight:"40px",padding:"0",fontSize:"15px",marginLeft:"1rem"},children:[i.jsx(ot,{className:"mr-2",style:{fontSize:"18px"}}),"Đặt lại"]})]})]})]})}),i.jsx(Tt,{open:m,autoHideDuration:3e3,onClose:k,message:w})]})})};export{It as default};
