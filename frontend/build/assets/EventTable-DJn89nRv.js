import{aH as F,r as t,j as e,L as w,aC as G,B as f,aM as U,b6 as J,aO as R,as as D,aE as T,aL as V}from"./index-D4RF4o2o.js";import{I as W}from"./index.esm-BbI8Mix8.js";import{a as Y}from"./index.esm-2JYdzJ0b.js";import{f as E}from"./format-BID3j3lB.js";const ne=()=>{const j=F(),[h,y]=t.useState([]),[b,v]=t.useState(!1),[I,H]=t.useState(0),[c,K]=t.useState(1),[i,M]=t.useState(5),[m,P]=t.useState(""),[u,Z]=t.useState(),[z,x]=t.useState(!1),[g,N]=t.useState(null),[p,_]=t.useState([null,null]),S=async(s,l,n,a,o)=>{v(!0);try{let r="http://localhost:8080/api/v1/event/all";const d={page:s,size:l};n?(r="/event/search",d.query=n):a?(r="/event/filter",d.status=a):o&&o[0]&&o[1]&&(r="http://localhost:8080/api/v1/event/filter-date",d.startDate=E(o[0],"yyyy-MM-dd'T'HH:mm:ss"),d.endDate=E(o[1],"yyyy-MM-dd'T'HH:mm:ss"));const C=await D.get(r,{params:d});y(C.data.content),H(C.data.totalElements)}catch(r){console.error("Error fetching events:",r)}finally{v(!1)}};t.useEffect(()=>{S(c,i,m,u,p)},[c,i,m,u,p]);const B=s=>{P(s.target.value)},L=()=>{j("/admin/manage/event/add")},O=s=>{console.log("Id là: ",s),j(`/admin/manage/event/update/${s}`)},X=s=>{K(s)},$=s=>{M(s)},Q=s=>{N(s),x(!0)},k=()=>{x(!1),N(null)},q=async()=>{if(console.log("Runn...."),g!==null)try{await D.delete(`/event/delete/${g}`),T.success("Xóa thành công"),y(h.filter(s=>s.id!==g)),x(!1),S(c,i,m,u,p)}catch{T.error("Xóa thất bại")}},A=[{header:"STT",id:"serialNumber",cell:({row:s})=>(c-1)*i+s.index+1},{header:"Mã",accessorKey:"discountCode"},{header:"Tên",accessorKey:"name"},{header:"Giá trị giảm(%)",accessorKey:"discountPercent"},{header:"Ngày bắt đầu",accessorKey:"startDate",cell:({row:s})=>e.jsx("p",{children:s.original.startDate})},{header:"Ngày kết thúc",accessorKey:"endDate",cell:({row:s})=>e.jsx("p",{children:s.original.endDate})},{header:"Số lượng",accessorKey:"quantityDiscount"},{header:"Trạng thái",accessorKey:"status",cell:({row:s})=>{const{status:l}=s.original;let n="",a="";switch(l){case"Đang diễn ra":n="Đang diễn ra",a="text-green-600";break;case"Sắp diễn ra":n="Sắp diễn ra",a="text-yellow-600";break;case"Đã kết thúc":n="Đã kết thúc",a="text-red-600";break;default:n="Không hoạt động",a="text-gray-600"}return e.jsxs("span",{className:`flex items-center font-bold ${a}`,children:[e.jsx("span",{className:`inline-block w-2 h-2 rounded-full mr-2 ${a.replace("text-","bg-")}`}),n]})},size:100},{header:"Hành động",cell:({row:s})=>{const l=s.original;return e.jsxs("div",{className:"flex w-full justify-start gap-2 items-center",children:[e.jsx(V,{size:20,className:"mr-3",style:{cursor:"pointer"},onClick:()=>O(l.id)}),e.jsx(Y,{size:20,style:{cursor:"pointer"},onClick:()=>Q(l.id)})]})}}];return e.jsx("div",{className:"bg-white rounded-lg mb-6 w-full h-full",children:e.jsxs("div",{className:"p-5 rounded-md card h-full card-border",children:[e.jsx("div",{className:"lg:flex items-center justify-between mb-4",children:e.jsx("nav",{className:"flex","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:"inline-flex items-center space-x-1 md:space-x-3",children:[e.jsx("li",{children:e.jsx("div",{className:"flex items-center",children:e.jsx(w,{to:"/",className:"text-gray-700 hover:text-blue-600",children:"Trang Chủ"})})}),e.jsx("li",{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mx-2",children:"/"}),e.jsx(w,{to:"/manage",className:"text-gray-700 hover:text-blue-600",children:"Quản Lý"})]})}),e.jsx("li",{"aria-current":"page",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mx-2",children:"/"}),e.jsx("span",{className:"text-gray-500",children:"Đợt giảm giá"})]})})]})})}),e.jsx("h1",{className:"font-semibold text-xl mb-4 uppercase",children:"Quản lý đợt giảm giá"}),e.jsx("div",{className:"bg-white",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"relative w-[500px]",children:[e.jsx(G,{placeholder:"Tìm kiếm theo mã, tên...",size:"sm",className:"w-full pl-10 pr-2 py-2 border border-gray-300 rounded focus:outline-none bg-white h-10",onChange:B}),e.jsx(W,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-500 text-2xl"})]})}),e.jsx(f,{variant:"solid",style:{backgroundColor:"rgb(79, 70, 229)",height:"40px"},className:"flex items-center justify-center gap-2 button-bg-important h-10",icon:e.jsx(U,{}),onClick:L,children:"Thêm mới"})]})}),e.jsx("div",{className:"bg-white rounded-lg py-6",children:e.jsx("div",{className:"overflow-x-auto",children:b?e.jsx("p",{children:"Đang tải..."}):h.length===0?e.jsx("p",{children:"Không có dữ liệu event."}):e.jsx(J,{columns:A,data:h,loading:b,pagingData:{pageIndex:c,pageSize:i,total:I},onPaginationChange:X,onSelectChange:$})})}),e.jsxs(R,{isOpen:z,closable:!1,onClose:k,children:[e.jsx("h5",{className:"mb-4",children:"Xác nhận xóa sự kiện"}),e.jsx("p",{children:"Bạn có chắc chắn muốn xóa sự kiện này không?"}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(f,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:k,children:"Hủy"}),e.jsx(f,{variant:"solid",style:{backgroundColor:"rgb(79, 70, 229)",height:"40px"},type:"submit",onClick:q,children:"Xác nhận"})]})]})]})})};export{ne as default};
